<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>equeum-graphql-server</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.js" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">equeum-graphql-server</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1> equeum-graphql-server</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#equeum-graphql-server" id="equeum-graphql-server" style="color: inherit; text-decoration: none;">
					<h1>Equeum GraphQL Server</h1>
				</a>
				<p>Implementation of GraphQL server. Takes in type definitions and resolvers and configures GraphQL server with authenticated user data in context and other standard things. Apollo Federation ready. Also exports Equeum specific type definitions.</p>
				<a href="#requirements" id="requirements" style="color: inherit; text-decoration: none;">
					<h2>Requirements</h2>
				</a>
				<p>Scripts inside package.json rely on <a href="https://www.npmjs.com/package/npx">npx</a> to be installed globally. To install it run:</p>
				<pre><code>npm <span class="hljs-keyword">install</span> -g npx</code></pre><p>You also need EqueumRESTServer as it provides standard implementation for web service and provides authentification and security.</p>
				<pre><code>npm install git+ssh:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/equeumco/</span>equeum-rest-server.git</code></pre>
				<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
					<h2>Installation</h2>
				</a>
				<pre><code>npm install git+ssh:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/equeumco/</span>equeum-graphql-server.git</code></pre>
				<a href="#working-example" id="working-example" style="color: inherit; text-decoration: none;">
					<h2>Working example</h2>
				</a>
				<pre><code><span class="hljs-keyword">import</span> express, { Router, Request, Response } <span class="hljs-keyword">from</span> <span class="hljs-string">'express'</span>;
<span class="hljs-keyword">import</span> EqueumRESTServer <span class="hljs-keyword">from</span> <span class="hljs-string">'equeum-rest-server'</span>;
<span class="hljs-keyword">import</span> EqueumGraphQLServer <span class="hljs-keyword">from</span> <span class="hljs-string">'equeum-graphql-server'</span>;

const app = express();

const typeDefs = `<span class="javascript">
  type Query {
    <span class="hljs-attr">testQuery</span>: <span class="hljs-built_in">String</span>
  }
</span>`;

const resolvers = {
  Query: {
    testQuery: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-string">'Test response'</span>
  }
};

<span class="hljs-keyword">new</span> EqueumRESTServer({
  app,
  <span class="hljs-regexp">//</span> We need to pass <span class="hljs-keyword">this</span> here to make sure /graphql route <span class="hljs-keyword">is</span> just checked <span class="hljs-keyword">for</span> auth
  <span class="hljs-regexp">//</span> but <span class="hljs-keyword">not</span> handled <span class="hljs-keyword">by</span> REST server <span class="hljs-keyword">and</span> left <span class="hljs-keyword">for</span> GraphQL server
  passThroughRoutes: [<span class="hljs-string">'/graphql'</span>],
  addAuthToRoutes: [<span class="hljs-string">'/graphql]
});
new EqueumGraphQLServer({
  app,
  typeDefs,
  resolvers
});

const port: number = 4000;
app.listen(port, () =&gt; console.log(`Server is listening on http://localhost:${port}`));</span></code></pre><p>If using <a href="https://typegraphql.ml/">TypeGraphQL</a> for automatically generating schema you first build type definitions and resolvers and then pass them to the constructor.</p>
				<pre><code><span class="hljs-keyword">import</span> { buildTypeDefsAndResolvers } <span class="hljs-keyword">from</span> <span class="hljs-string">'type-graphql'</span>;

buildTypeDefsAndResolvers({ resolvers: [ ... ] }).<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">({ typeDefs, resolvers })</span> =&gt;</span> {
  <span class="hljs-keyword">new</span> EqueumGraphQLServer({
    app,
    typeDefs,
    resolvers,
  });
});</code></pre>
				<a href="#equeumgraphqlserver-default-export" id="equeumgraphqlserver-default-export" style="color: inherit; text-decoration: none;">
					<h2>EqueumGraphQLServer (default export)</h2>
				</a>
				<p>Main class containing GraphQL server implementation. <a href="#working-example">Working example</a> has copy-paste ready code to bootsrap the server.</p>
				<a href="#authentification" id="authentification" style="color: inherit; text-decoration: none;">
					<h3>Authentification</h3>
				</a>
				<p>EqueumGraphQL server relies on EqueumRESTServer to verify JWT token and add user data to request object. It expects all requests that pass REST server auth middleware to be authenticated. It then reads user data from request object and populates GraphQL context with that data.</p>
				<a href="#constructor-parameters" id="constructor-parameters" style="color: inherit; text-decoration: none;">
					<h3>Constructor Parameters</h3>
				</a>
				<a href="#app-application" id="app-application" style="color: inherit; text-decoration: none;">
					<h4>app: Application</h4>
				</a>
				<p>Express app object to build the server over</p>
				<a href="#typedefs-any" id="typedefs-any" style="color: inherit; text-decoration: none;">
					<h4>typeDefs: any</h4>
				</a>
				<p>GraphQL type definitions</p>
				<a href="#resolvers-iresolversltany-anygt--iresolversltany-anygt" id="resolvers-iresolversltany-anygt--iresolversltany-anygt" style="color: inherit; text-decoration: none;">
					<h4>resolvers: IResolvers&lt;any, any&gt; | IResolvers&lt;any, any&gt;[]</h4>
				</a>
				<p>Resolver functions</p>
				<a href="#types" id="types" style="color: inherit; text-decoration: none;">
					<h2>Types</h2>
				</a>
				<a href="#equeumcontext" id="equeumcontext" style="color: inherit; text-decoration: none;">
					<h3>EqueumContext</h3>
				</a>
				<p>This type defines context that will be available inside each resover.</p>
				<a href="#decorators" id="decorators" style="color: inherit; text-decoration: none;">
					<h2>Decorators</h2>
				</a>
				<a href="#requirerole" id="requirerole" style="color: inherit; text-decoration: none;">
					<h3>RequireRole</h3>
				</a>
				<p>Decorator to be used for access control. By default we suppose that all GraphQL resources are accessible to all users. If we want to limit the access to specific resource, we can add RequireROle decorator to resolver annotation. Valid roles are &#39;ADMIN&#39; or &#39;MACHINE&#39;, you can also supply multiple roles that are allowed to access this resource by providing an array like [&#39;ADMIN&#39;, &#39;MACHINE&#39;].</p>
				<pre><code><span class="hljs-meta">@RequireRole</span>(<span class="hljs-string">'ADMIN'</span>)
<span class="hljs-meta">@Query</span>(<span class="hljs-function"><span class="hljs-params">returns</span> =&gt;</span> <span class="hljs-built_in">String</span>)
<span class="hljs-keyword">async</span> test(): <span class="hljs-built_in">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-string">'I will only be seen by ADMIN'</span>;
}</code></pre><pre><code><span class="hljs-meta">@RequireRole</span>([<span class="hljs-string">'ADMIN'</span>, <span class="hljs-string">'MACHINE'</span>])
<span class="hljs-meta">@Query</span>(<span class="hljs-function"><span class="hljs-params">returns</span> =&gt;</span> <span class="hljs-built_in">String</span>)
<span class="hljs-keyword">async</span> test(): <span class="hljs-built_in">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-string">'I will only be seen by ADMIN or MACHINE'</span>;
}</code></pre>
				<a href="#error-handling" id="error-handling" style="color: inherit; text-decoration: none;">
					<h2>Error handling</h2>
				</a>
				<p>All the errors thrown inside resolvers are returned to user. Currently way too detailed error information is sent back. Error handling is a subject to be upgraded heavily in a near future.</p>
				<a href="#documentation" id="documentation" style="color: inherit; text-decoration: none;">
					<h2>Documentation</h2>
				</a>
				<p>Class and type reference can be found under <a href="./docs">/docs</a></p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_equeumgraphqlserver_.html">"<wbr>Equeum<wbr>GraphQLServer"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_decorators_requirerole_.html">"decorators/<wbr>Require<wbr>Role"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_decorators_index_.html">"decorators/index"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_index_.html">"index"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_types_authenticateduserdata_.html">"types/<wbr>Authenticated<wbr>User<wbr>Data"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_types_equeumcontext_.html">"types/<wbr>Equeum<wbr>Context"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_types_equeumgraphqlserverparams_.html">"types/<wbr>Equeum<wbr>GraphQLServer<wbr>Params"</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/_types_index_.html">"types/index"</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-module"><span class="tsd-kind-icon">Module</span></li>
				<li class="tsd-kind-object-literal"><span class="tsd-kind-icon">Object literal</span></li>
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
				<li class="tsd-kind-index-signature"><span class="tsd-kind-icon">Index signature</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
				<li class="tsd-kind-type-alias tsd-has-type-parameter"><span class="tsd-kind-icon">Type alias with type parameter</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
				<li class="tsd-kind-enum-member"><span class="tsd-kind-icon">Enumeration member</span></li>
				<li class="tsd-kind-property tsd-parent-kind-enum"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-enum"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
				<li class="tsd-kind-interface tsd-has-type-parameter"><span class="tsd-kind-icon">Interface with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-interface"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-interface"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
				<li class="tsd-kind-class tsd-has-type-parameter"><span class="tsd-kind-icon">Class with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class"><span class="tsd-kind-icon">Accessor</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-class"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li>
				<li class="tsd-kind-call-signature tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="assets/js/search.js"><' + '/script>');</script>
</body>
</html>